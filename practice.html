<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Hour-wise Attendance</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://unpkg.com/html5-qrcode"></script>
</head>
<body>
<div class="container mt-4">
    <h2 class="mb-3">Scan Attendance</h2>
    <div id="reader" style="width:500px;"></div>

    <h2 class="mt-5">Today's Attendance</h2>
    <table class="table table-striped table-bordered">
        <thead>
            <tr>
                <th>Id</th>
                <th>Name</th>
                <th>Time</th>
                <th>Hour</th>
            </tr>
        </thead>
        <tbody id="t_body"></tbody>
    </table>
</div>
 <div class="box">
    <input type="text" id="studentName" placeholder="Enter Student Name">
    <input type="text" id="studentId" placeholder="Enter Student ID">
    <button id="saveBtn">ğŸ’¾ Save to Firestore</button>
  </div>
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-app.js";
import { getFirestore, collection, setDoc,addDoc,getDoc, query, orderBy, onSnapshot, getDocs, doc } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-firestore.js";


// ===== FIREBASE CONFIG =====
const firebaseConfig = {
  apiKey: "AIzaSyDXYuGsHV-u8HzDbBCrLDJAhTAYdSDjI8Q",
  authDomain: "attendence-bc81d.firebaseapp.com",
  projectId: "attendence-bc81d",
  storageBucket: "attendence-bc81d.firebasestorage.app",
  messagingSenderId: "804910602579",
  appId: "1:804910602579:web:eb61bbb3a2c6b1ef1229a6",
  measurementId: "G-CBCKQTJ9ZM"
};
const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

// ===== QR SCANNER =====



let html5QrcodeScanner = new Html5QrcodeScanner(
    "reader",
    { fps: 10, qrbox: {width:250, height:250} },
    false
);

function onScanSuccess(decodedResult){
    const res = JSON.parse(decodedResult);
  console.log(res);
  

    // addDoc(collection(db, "Attendance", {
    //     name: res.studentName,
    //     studentID: res.studentId,
    //     Time: Date.toString()
    // }).then(() => {
    //     console.log("Attendance added:", res);
    // }).catch(err => console.log(err)))

    // html5QrcodeScanner.pause(true);
    // setTimeout(() => html5QrcodeScanner.resume(), 3000);
}

function onScanFailure(error){
    console.log(error);
    
}

// Start scanner
html5QrcodeScanner.render(onScanSuccess, onScanFailure);






// ========================= NEW CODE START ===========================
document.getElementById("save-btn").addEventListener("click",()=>{
  var studentName = document.getElementById("studentName").value.trim();
var studentId = document.getElementById("studentId").value.trim();



})
// ========================= NEW CODE END =============================

// ===== DISPLAY ALL HOURS ATTENDANCE =====
  async function getDayDocument() {
    const ref = doc(db, "fasih", "day"); // ğŸ‘ˆ path: Attendance/day

    const snap = await getDoc(ref);

    if (snap.exists()) {
      console.log("âœ… Day document data:", snap.data());
    } else {
      console.log("âŒ No such document found in Attendance/day");
    }
  }

  getDayDocument();


</script>
</body>
</html>
